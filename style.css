@import url("https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=IM+Fell+English+SC&display=swap");
:root {
  --bg-dark: #1a1a1a;
  --panel-bg: #1f1614;
  --panel-border: #e6c253;
  --text-light: #e0e0e0;
  --text-gold: #e6c253;
  --header-bg: #3a2e2a;
  --header-hover: #4a3f3c;
  --content-bg: #2a221f;
  --input-bg: #1a1a1a;
  --input-border: #4a3f3c;
  --button-primary-bg: linear-gradient(to bottom, #8c5a2d, #593a1d);
  --button-primary-hover: linear-gradient(to bottom, #a16a35, #6b4623);
  --button-vision-bg: linear-gradient(to bottom, #2d8c3e, #1d5927);
  --button-vision-hover: linear-gradient(to bottom, #35a14a, #236b2f);
}

body {
  margin: 0;
  font-family: "Cinzel", serif;
  background-color: var(--bg-dark);
  color: var(--text-light);
  overflow: hidden;
}
.container {
  display: flex;
  height: 100vh;
}
.controls-panel {
  width: 450px;
  background: var(--panel-bg);
  padding: 20px;
  box-shadow: 5px 0 15px rgba(0, 0, 0, 0.5);
  overflow-y: auto; /* Muestra el scroll solo si es necesario */
  scrollbar-gutter: stable; /* ¡LA SOLUCIÓN! Reserva el espacio siempre */
  flex-shrink: 0;
  border-right: 2px solid var(--panel-border);
}
h2 {
  font-family: "IM Fell English SC", serif;
  font-size: 2em;
  text-align: center;
  color: var(--text-gold);
  margin: 0 0;
  text-shadow: 1px 1px 3px #000;
}
.divisor {
  border-bottom: 1px solid var(--text-gold);
  text-align: center;
  margin-bottom: 20px !important;
  padding-bottom: 10px;
}
.leyenda {
  text-align: center;
}
h4 {
  font-family: "IM Fell English SC", serif;
  color: var(--text-gold);
  border-bottom: 1px dotted var(--input-border);
  padding-bottom: 5px;
  margin-bottom: 10px;
}
h4.top-margin {
  margin-top: 20px;
}
.collapsible {
  margin-bottom: 10px;
  border: 1px solid var(--input-border);
  border-radius: 5px;
  background-color: rgba(0, 0, 0, 0.1);
}
.collapsible-header {
  background: var(--header-bg);
  color: #d4b574;
  padding: 12px 15px;
  cursor: pointer;
  position: relative;
  user-select: none;
  transition: background-color 0.3s;
  margin: 0;
  font-size: 1.1em;
  font-family: "Cinzel", serif;
  display: flex; /* Habilitar flexbox para alinear icono y texto */
  align-items: center; /* Centrar verticalmente icono y texto */
}
.collapsible-header:hover {
  background: var(--header-hover);
}
.collapsible-header::after {
  content: "+";
  font-weight: bold;
  color: var(--text-gold);
  position: absolute;
  right: 15px;
  top: 50%;
  font-size: 1.2em;
  transform: translateY(-50%);
  transition: 0.3s;
}
.collapsible.active .collapsible-header::after {
  transform: translateY(-50%) rotate(45deg);
}
.collapsible-content {
  max-height: 0;
  overflow: auto;
  transition: 0.3s;
  padding: 0 15px;
  background-color: var(--content-bg);
}
.collapsible.active .collapsible-content {
  max-height: 1900px; /* Valor alto para permitir contenido grande */
  padding: 15px;
}

/* --- NUEVO: ESTILOS PARA LOS ICONOS EN LOS HEADERS --- */
.header-icon {
  display: inline-block; /* Asegura que el span se comporte como un bloque en línea */
  width: 1.3em; /* Ajusta el tamaño del icono */
  height: 1.3em; /* Ajusta el tamaño del icono */
  margin-right: 10px; /* Espacio entre el icono y el texto */
  vertical-align: middle; /* Alinea el icono con el centro del texto */
  background-size: contain; /* Ajusta la imagen para que quepa sin distorsionarse */
  background-repeat: no-repeat; /* Evita que la imagen se repita */
  background-position: center; /* Centra la imagen en el espacio del span */
}

/* --- NUEVO: CLASES ESPECÍFICAS PARA CADA ICONO DE HEADER --- */
/* REEMPLAZA 'path/to/your-icon.png' CON LA RUTA REAL DE TUS ARCHIVOS */
.icon-map {
  background-image: url("https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/465e4532-5430-4be7-b49c-acf81087d8bd/dk2807e-bf125877-efc8-4136-97d7-e6b8bd53da39.png/v1/fit/w_674,h_707/mapa_icon_by_rafaelalvarez29_dk2807e-375w-2x.png?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7ImhlaWdodCI6Ijw9NzA3IiwicGF0aCI6IlwvZlwvNDY1ZTQ1MzItNTQzMC00YmU3LWI0OWMtYWNmODEwODdkOGJkXC9kazI4MDdlLWJmMTI1ODc3LWVmYzgtNDEzNi05N2Q3LWU2YjhiZDUzZGEzOS5wbmciLCJ3aWR0aCI6Ijw9Njc0In1dXSwiYXVkIjpbInVybjpzZXJ2aWNlOmltYWdlLm9wZXJhdGlvbnMiXX0.KFdtHEY3m67t_O4ES74Pr_pH9yK6Oa3n0Yc6MJR3tAA");
}
.icon-tools {
  background-image: url("https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/465e4532-5430-4be7-b49c-acf81087d8bd/dk27wwu-0fccb350-f3fd-4e7d-a4d4-102adad26f4e.png/v1/fill/w_902,h_859/herramientas_icon_by_rafaelalvarez29_dk27wwu-fullview.png?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7ImhlaWdodCI6Ijw9ODU5IiwicGF0aCI6IlwvZlwvNDY1ZTQ1MzItNTQzMC00YmU3LWI0OWMtYWNmODEwODdkOGJkXC9kazI3d3d1LTBmY2NiMzUwLWYzZmQtNGU3ZC1hNGQ0LTEwMmFkYWQyNmY0ZS5wbmciLCJ3aWR0aCI6Ijw9OTAyIn1dXSwiYXVkIjpbInVybjpzZXJ2aWNlOmltYWdlLm9wZXJhdGlvbnMiXX0.ok1Yedsu8VvTHTDBLl9AnbutC-UIhQ2IKtd-jzarkqY");
}
.icon-walls {
  background-image: url("https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/465e4532-5430-4be7-b49c-acf81087d8bd/dk27xrv-d8c11b91-d059-42e1-922c-39233f7d587f.png/v1/fill/w_884,h_837/muro_icon_by_rafaelalvarez29_dk27xrv-fullview.png?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7ImhlaWdodCI6Ijw9ODM3IiwicGF0aCI6IlwvZlwvNDY1ZTQ1MzItNTQzMC00YmU3LWI0OWMtYWNmODEwODdkOGJkXC9kazI3eHJ2LWQ4YzExYjkxLWQwNTktNDJlMS05MjJjLTM5MjMzZjdkNTg3Zi5wbmciLCJ3aWR0aCI6Ijw9ODg0In1dXSwiYXVkIjpbInVybjpzZXJ2aWNlOmltYWdlLm9wZXJhdGlvbnMiXX0.Gsorh3ss3jCQIFRYym-JjKfx7KIgnU6l3DuI3KM02bw");
}
.icon-doors {
  background-image: url("https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/465e4532-5430-4be7-b49c-acf81087d8bd/dk27xzc-36669da6-1875-409f-83e5-61a04b750924.png/v1/fit/w_602,h_848/puerta_icon_by_rafaelalvarez29_dk27xzc-375w-2x.png?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7ImhlaWdodCI6Ijw9ODQ4IiwicGF0aCI6IlwvZlwvNDY1ZTQ1MzItNTQzMC00YmU3LWI0OWMtYWNmODEwODdkOGJkXC9kazI3eHpjLTM2NjY5ZGE2LTE4NzUtNDA5Zi04M2U1LTYxYTA0Yjc1MDkyNC5wbmciLCJ3aWR0aCI6Ijw9NjAyIn1dXSwiYXVkIjpbInVybjpzZXJ2aWNlOmltYWdlLm9wZXJhdGlvbnMiXX0.Y989bL2cMG4fX4jmwQvfM2hTQZmPqv1oTh9DEXIIp44");
}
.icon-add-token {
  background-image: url("https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/465e4532-5430-4be7-b49c-acf81087d8bd/dk27ye7-655a6bcb-69d8-47cf-9e4f-787f7df50155.png/v1/fit/w_709,h_709/mas_icon_by_rafaelalvarez29_dk27ye7-375w-2x.png?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7ImhlaWdodCI6Ijw9NzA5IiwicGF0aCI6IlwvZlwvNDY1ZTQ1MzItNTQzMC00YmU3LWI0OWMtYWNmODEwODdkOGJkXC9kazI3eWU3LTY1NWE2YmNiLTY5ZDgtNDdjZi05ZTRmLTc4N2Y3ZGY1MDE1NS5wbmciLCJ3aWR0aCI6Ijw9NzA5In1dXSwiYXVkIjpbInVybjpzZXJ2aWNlOmltYWdlLm9wZXJhdGlvbnMiXX0.zANMzZbMmR267V7d1EHx_0KrkjNwGrFw1pnf34Lk3rU");
}
.icon-selected-token {
  background-image: url("https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/465e4532-5430-4be7-b49c-acf81087d8bd/dk27yjb-e545e4ee-c2dd-4905-b1b8-416737a0265b.png/v1/fit/w_493,h_721/seleccionado_icon_by_rafaelalvarez29_dk27yjb-375w-2x.png?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7ImhlaWdodCI6Ijw9NzIxIiwicGF0aCI6IlwvZlwvNDY1ZTQ1MzItNTQzMC00YmU3LWI0OWMtYWNmODEwODdkOGJkXC9kazI3eWpiLWU1NDVlNGVlLWMyZGQtNDkwNS1iMWI4LTQxNjczN2EwMjY1Yi5wbmciLCJ3aWR0aCI6Ijw9NDkzIn1dXSwiYXVkIjpbInVybjpzZXJ2aWNlOmltYWdlLm9wZXJhdGlvbnMiXX0.AHsXpddc5nKb4Et8VyhMGhF75DnyJ8Msi_YiVa_cb8U");
}
.icon-tokens {
  background-image: url("https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/465e4532-5430-4be7-b49c-acf81087d8bd/dk29d0m-fbc2566a-dfea-4e3d-9b40-752f87b4cd24.png/v1/fit/w_719,h_775/fichas_icon_1_by_rafaelalvarez29_dk29d0m-375w-2x.png?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7ImhlaWdodCI6Ijw9Nzc1IiwicGF0aCI6IlwvZlwvNDY1ZTQ1MzItNTQzMC00YmU3LWI0OWMtYWNmODEwODdkOGJkXC9kazI5ZDBtLWZiYzI1NjZhLWRmZWEtNGUzZC05YjQwLTc1MmY4N2I0Y2QyNC5wbmciLCJ3aWR0aCI6Ijw9NzE5In1dXSwiYXVkIjpbInVybjpzZXJ2aWNlOmltYWdlLm9wZXJhdGlvbnMiXX0.H9jU7bpIClEtk0r0joZ56VmIaFeM3-H8wu69owImg-g");
}

/* --- FORMULARIOS Y BOTONES (con textarea) --- */
label {
  display: block;
  margin: 10px 0 5px;
  font-size: 0.9em;
}
label.inline-label {
  display: flex;
  align-items: center;
  margin: 5px 0;
}
input[type="text"],
input[type="number"],
input[type="file"],
textarea {
  width: calc(100% - 22px);
  padding: 8px 10px;
  background-color: var(--input-bg);
  border: 1px solid var(--input-border);
  border-radius: 3px;
  color: var(--text-light);
  font-family: "Cinzel", serif;
  margin-bottom: 5px;
}
textarea {
  resize: vertical;
}
input[type="color"] {
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  width: 100%;
  height: 30px;
  background-color: transparent;
  border: 1px solid var(--input-border);
  cursor: pointer;
  padding: 0;
}
input[type="color"]::-webkit-color-swatch {
  border: none;
  border-radius: 3px;
}
input[type="color"]::-moz-color-swatch {
  border: none;
  border-radius: 3px;
}
input[type="checkbox"],
input[type="radio"] {
  margin-right: 8px;
}
.radio-group {
  display: flex;
  gap: 15px;
  margin: 5px 0 10px;
}
button {
  width: 100%;
  padding: 12px;
  margin-top: 15px;
  font-family: "IM Fell English SC", serif;
  font-size: 1.2em;
  color: var(--text-gold);
  border: 1px solid var(--text-gold);
  border-radius: 5px;
  cursor: pointer;
  text-shadow: 1px 1px 2px #000;
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.2),
    0 2px 3px rgba(0, 0, 0, 0.5);
  transition: all 0.2s;
  background: var(--button-primary-bg);
}
button:hover {
  background: var(--button-primary-hover);
  color: #fff;
}
button.secondary {
  background: var(--header-hover);
  border-color: var(--input-border);
}
button.secondary:hover {
  background: var(--header-bg);
}
.button-group {
  display: flex;
  gap: 10px;
  margin-top: 10px;
}
.button-group button {
  width: 50%;
  margin-top: 0;
}

/* --- GRUPO DE BOTONES DE VISIÓN --- */
.vision-controls-group {
  display: flex;
  gap: 10px;
  margin-top: 15px;
  align-items: stretch;
}
#toggleVisionBtn {
  flex-grow: 1;
  margin-top: 0;
  background: var(--button-vision-bg);
  border-color: #5dc66f;
  color: #5dc66f;
}
#toggleVisionBtn:hover {
  background: var(--button-vision-hover);
  color: #fff;
}
#resetFogBtn {
  flex-grow: 0;
  flex-shrink: 0;
  width: 45px;
  margin-top: 0;
  padding: 0;
  font-size: 1.5em;
  font-family: "IM Fell English SC", serif;
  background: linear-gradient(to bottom, #8c2d2d, #591d1d);
  border-color: #c65d5d;
  color: #c65d5d;
}
#resetFogBtn:hover {
  background: linear-gradient(to bottom, #a13535, #6b2323);
  color: #fff;
  border-color: #ff8a8a;
}

/* --- EDITOR DE FICHA SELECCIONADA --- */
#tokenEditor {
  display: none;
}
#selectedTokenSection.has-selection #noTokenSelected {
  display: none;
}
#selectedTokenSection.has-selection #tokenEditor {
  display: block;
}
.token-editor-form {
  padding: 10px;
  background: rgba(0, 0, 0, 0.1);
  border-radius: 5px;
}
.token-editor-form .form-header h3 {
  text-align: center;
  margin: 0 0 15px;
  color: #c0c0c0;
  font-size: 1em;
}
.token-editor-form h4 {
  font-family: "IM Fell English SC", serif;
  color: var(--text-gold);
  border-bottom: 1px dotted var(--input-border);
  padding-bottom: 5px;
  margin: 20px 0 10px;
  font-size: 1.2em;
}
.form-row {
  display: flex;
  gap: 10px;
}
.form-group {
  flex-grow: 1;
  margin-bottom: 10px;
}
.form-group label {
  margin-top: 0;
}
.token-editor-form .button-group {
  margin-top: 20px;
}

/* Controles de Vida */
.health-controls {
  background-color: rgba(0, 0, 0, 0.3);
  border: 1px solid var(--input-border);
  border-radius: 8px;
  padding: 15px;
  margin-top: 15px;
  text-align: center;
}
.health-controls label {
  font-size: 0.8em;
  color: #a0a0a0;
}
.health-display-container {
  position: relative;
  margin-bottom: 15px;
}
.health-display {
  font-size: 32px;
  font-weight: bold;
  font-family: "Cinzel", serif;
  transition: color 0.3s ease;
}
.health-high {
  color: #5dff8b;
  text-shadow: 0 0 8px rgba(93, 255, 139, 0.7);
}
.health-mid {
  color: #ffee5d;
  text-shadow: 0 0 8px rgba(255, 238, 93, 0.7);
}
.health-low {
  color: #ff5d5d;
  text-shadow: 0 0 8px rgba(255, 93, 93, 0.7);
}
.health-critical {
  animation: blink-red 1s infinite;
}
@keyframes blink-red {
  0%,
  100% {
    color: #ff5d5d;
    text-shadow: 0 0 8px rgba(255, 93, 93, 0.7);
  }
  50% {
    color: #a93232;
    text-shadow: none;
  }
}
.health-modifier-row {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 8px;
}
.health-modifier-btn {
  width: 40px;
  height: 35px;
  padding: 0;
  font-family: "Cinzel", serif;
  font-size: 1em;
  background: #3a3a3a;
  border-radius: 3px;
  box-shadow: none;
  margin-top: 0;
  top: 0;
}
.health-modifier-btn.negative {
  border: 1px solid #c65d5d;
  color: #c65d5d;
}
.health-modifier-btn.negative:hover {
  background: #4a3f3c;
  color: #ff8a8a;
}
.health-modifier-btn.positive {
  border: 1px solid #5dc66f;
  color: #5dc66f;
}
.health-modifier-btn.positive:hover {
  background: #4a3f3c;
  color: #8affad;
}
.health-modifier-input {
  width: 60px;
  text-align: center;
  font-size: 1.1em;
  padding: 4px;
  margin: 0;
}
.help-text {
  font-size: 0.8em;
  color: #888;
  font-style: italic;
  margin-top: 10px;
}

/* Animación de número flotante */
.damage-float {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 24px;
  font-weight: bold;
  pointer-events: none;
  animation: float-and-fade 1s ease-out forwards;
  z-index: 1001;
}
.damage-float.heal {
  color: #5dff8b;
}
.damage-float.damage {
  color: #ff5d5d;
}
@keyframes float-and-fade {
  to {
    transform: translate(-50%, -150%);
    opacity: 0;
  }
}

/* --- LISTA DE FICHAS REDISEÑADA --- */
#tokenList {
  list-style: none;
  padding: 0;
  max-height: 350px;
  overflow-y: auto;
}
#tokenList li {
  background-color: rgba(0, 0, 0, 0.2);
  border-bottom: 1px solid var(--input-border);
  padding: 10px;
  border-radius: 3px;
  cursor: pointer;
  transition: background-color 0.2s;
  display: grid;
  grid-template-columns: 40px 1fr auto;
  grid-template-rows: auto auto;
  gap: 2px 10px;
  align-items: center;
}
#tokenList li:hover {
  background-color: var(--header-hover);
}
.token-list-preview {
  grid-row: 1 / 3;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;
  font-weight: bold;
  color: white;
  text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
  box-sizing: border-box;
}
.token-list-header {
  grid-column: 2 / 3;
  display: flex;
  align-items: center;
  font-size: 1.1em;
  font-weight: bold;
  color: var(--text-light);
}
/* Removimos el span del emoji aquí en el HTML, pero en JS lo manejaremos */
/* .token-list-header span {
  margin-right: 8px;
} */

/* --- NUEVO: ESTILO PARA EL ICONO EN LA LISTA DE FICHAS --- */
.token-list-icon {
  display: inline-block;
  width: 1.1em; /* Tamaño ajustado para la lista */
  height: 1.1em; /* Tamaño ajustado para la lista */
  margin-right: 8px;
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
}

/* --- NUEVO: CLASES ESPECÍFICAS PARA LOS ICONOS DE LISTA DE FICHAS --- */
/* REEMPLAZA LAS RUTAS */
.icon-player-list {
  background-image: url("https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/465e4532-5430-4be7-b49c-acf81087d8bd/dk280pi-d5a22ac5-2d1e-49cf-8950-ea3da33ffb94.png/v1/fit/w_720,h_867/jugador_icon_by_rafaelalvarez29_dk280pi-375w-2x.png?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7ImhlaWdodCI6Ijw9ODY3IiwicGF0aCI6IlwvZlwvNDY1ZTQ1MzItNTQzMC00YmU3LWI0OWMtYWNmODEwODdkOGJkXC9kazI4MHBpLWQ1YTIyYWM1LTJkMWUtNDljZi04OTUwLWVhM2RhMzNmZmI5NC5wbmciLCJ3aWR0aCI6Ijw9NzIwIn1dXSwiYXVkIjpbInVybjpzZXJ2aWNlOmltYWdlLm9wZXJhdGlvbnMiXX0.xFjM5mMj-NGZYvdFJzsZItT4jz5ZCERid4abqKijNNk");
  filter: drop-shadow(0 0 5px #fffbc8)
    /* Un resplandor exterior, rojo y más difuso */
    drop-shadow(0 0 15px #ffd30e);
  pointer-events: none;
} /* Reusamos el icono de tipo jugador/enemigo */
.icon-enemy-list {
  background-image: url("https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/465e4532-5430-4be7-b49c-acf81087d8bd/dk280si-23ebfeac-29eb-4e9a-9cf3-af3d666e6828.png/v1/fit/w_679,h_874/enemigo_icon_by_rafaelalvarez29_dk280si-375w-2x.png?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7ImhlaWdodCI6Ijw9ODc0IiwicGF0aCI6IlwvZlwvNDY1ZTQ1MzItNTQzMC00YmU3LWI0OWMtYWNmODEwODdkOGJkXC9kazI4MHNpLTIzZWJmZWFjLTI5ZWItNGU5YS05Y2YzLWFmM2Q2NjZlNjgyOC5wbmciLCJ3aWR0aCI6Ijw9Njc5In1dXSwiYXVkIjpbInVybjpzZXJ2aWNlOmltYWdlLm9wZXJhdGlvbnMiXX0.SEXeiU9RgxFAglrgdhWff-z-FCA_TyOJZ9SGd1CVsWU");
  filter: drop-shadow(0 0 12px rgb(255, 75, 255));
  pointer-events: none;
}

.token-list-details {
  grid-column: 2 / 3;
  font-size: 0.8em;
  color: #b0b0b0;
  display: flex;
  gap: 15px;
}
.delete-token-btn {
  grid-column: 3 / 4;
  grid-row: 1 / 3;
  align-self: center;
  background: #8c2d2d;
  color: white;
  border: 1px solid #c65d5d;
  width: 28px;
  height: 28px;
  padding: 0;
  font-size: 1.5em;
  line-height: 28px;
  border-radius: 3px;
  cursor: pointer;
  font-family: monospace;
}
.delete-token-btn:hover {
  background-color: #a13535;
}

/* --- ÁREA DEL MAPA Y FICHAS --- */

#mapContainer {
  position: relative; /* Para centrar el loading-state */
  flex-grow: 1;
  overflow: auto; /* ¡Este es nuestro scroller principal! */
  background-color: var(--bg-dark);
  cursor: grab;
}

/*#mapContainer:active {
     Opcional: Cambia el cursor para todo el contenedor mientras se hace clic */
/* Lo manejaremos con JS para más control, pero esto es una alternativa */
/* cursor: grabbing;
}*/
/* El nuevo wrapper que da tamaño al contenido */
#mapContentWrapper {
  position: relative; /* Es el contexto para apilar los canvas */
  display: none; /* Lo ocultamos hasta que se cargue un mapa */
  line-height: 0; /* Evita espacios extra fantasma */
}

/* La imagen base NO es absoluta. Su tamaño define el del wrapper */
#mapImage {
  position: relative;
  display: block;
}

/* Los canvas y la capa de fichas SÍ son absolutos para apilarse */
#gridCanvas,
#wallsCanvas,
#visionCanvas,
#tokensLayer {
  position: absolute;
  top: 0;
  left: 0;
  pointer-events: none; /* Por defecto no se puede hacer clic en ellos */
}

#tokensLayer {
  pointer-events: auto; /* Habilitamos clics en las fichas */
}

#visionCanvas {
  z-index: 4;
  display: none;
  pointer-events: none; /* ¡LA SOLUCIÓN! Los clics atravesarán este canvas */
}
.token {
  position: absolute;
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;
  font-weight: bold;
  color: white;
  cursor: grab;
  user-select: none;
  box-sizing: border-box;
  transition: opacity 0.3s ease, box-shadow 0.2s ease;
  text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
}
.token:active {
  cursor: grabbing;
  z-index: 100;
}
.token.hidden-enemy {
  opacity: 0;
  pointer-events: none;
}
.token.selected {
  box-shadow: 0 0 15px 5px #fffa86, 0 0 5px 2px #fff;
  z-index: 50;
}

/* FEATURE: Animaciones de daño/curación en la ficha */
.token.token-damaged {
  animation: token-flash-red 0.4s, token-shake 0.4s;
}
.token.token-healed {
  animation: token-pulse-green 0.5s;
}

@keyframes token-shake {
  10%,
  90% {
    transform: translate3d(-1px, 0, 0);
  }
  20%,
  80% {
    transform: translate3d(2px, 0, 0);
  }
  30%,
  50%,
  70% {
    transform: translate3d(-4px, 0, 0);
  }
  40%,
  60% {
    transform: translate3d(4px, 0, 0);
  }
}
@keyframes token-flash-red {
  0%,
  100% {
    box-shadow: inherit;
  }
  50% {
    box-shadow: 0 0 20px 10px rgba(255, 0, 0, 0.8);
  }
}
@keyframes token-pulse-green {
  0%,
  100% {
    box-shadow: inherit;
  }
  50% {
    box-shadow: 0 0 20px 10px rgba(0, 255, 100, 0.7);
  }
}
/* --- ESTILOS PARA EL LOGO DEL PANEL --- */
.panel-logo-container {
  text-align: center; /* Centra la imagen horizontalmente */
  padding: 5px 0; /* Añade un poco de espacio vertical */
  margin-bottom: 8px; /* Espacio entre el logo y el título h2 */
}

.panel-logo {
  max-width: 150px; /* Define el ancho máximo del logo. Ajústalo a tu gusto. */
  height: auto; /* Mantiene la proporción de la imagen */
}
/* Estilos para el nuevo contenedor de título del panel */
.panel-title-container {
  text-align: center;
  margin-bottom: 20px;
  padding-bottom: 10px;
  border-bottom: 1px solid var(--text-gold);
}

.panel-title-container h2 {
  margin: 0;
  padding: 0;
  border: none; /* Quitamos el borde que tenía antes h2 */
}

.panel-subtitle {
  margin: 5px 0 0 0;
  color: #c0c0c0; /* Un gris claro para no competir con el título */
  font-size: 0.9em;
  font-style: italic;
  font-family: "Cinzel", serif;
}
/* --- ESTILOS PARA EL INPUT DE ARCHIVO PERSONALIZADO --- */

/* Ocultamos el input de archivo por defecto de forma accesible */
.hidden-file-input {
  width: 0.1px;
  height: 0.1px;
  opacity: 0;
  overflow: hidden;
  position: absolute;
  z-index: -1;
}

/* Damos al label la apariencia de un botón */
.custom-file-upload-btn {
  display: inline-block; /* Para que respete el padding y margen */
  width: calc(100% - 24px); /* Ocupa todo el ancho menos el padding */
  padding: 12px;
  margin: 0 0 10px 0; /* Margen inferior para separarlo del nombre del archivo */
  font-family: "IM Fell English SC", serif;
  font-size: 1.1em;
  color: var(--text-gold);
  border: 1px dashed var(--input-border);
  border-radius: 5px;
  cursor: pointer;
  text-align: center;
  background: var(--header-bg);
  transition: background-color 0.2s, color 0.2s;
}

.custom-file-upload-btn:hover {
  background: var(--header-hover);
  color: #fff;
}

/* Estilo para el texto que muestra el nombre del archivo */
.file-name-display {
  display: block; /* Para que ocupe su propia línea */
  font-size: 0.8em;
  font-style: italic;
  color: #a0a0a0;
  margin-bottom: 15px; /* Espacio antes del siguiente grupo de botones */
  white-space: nowrap; /* Evita que el nombre del archivo se parta en varias líneas */
  overflow: hidden;
  text-overflow: ellipsis; /* Añade "..." si el nombre es muy largo */
}
/* --- ESTILOS PERSONALIZADOS PARA CHECKBOX Y RADIO BUTTONS (CORREGIDO) --- */

/* Contenedores para el layout */
.radio-group {
  display: flex;
  gap: 15px;
  align-items: center;
}
.radio-group > div,
.checkbox-container {
  display: flex;
  align-items: center;
  position: relative;
}

/* Ocultamos el input original */
input[type="checkbox"],
input[type="radio"] {
  opacity: 0;
  position: absolute;
  width: 0;
  height: 0;
}
input[type="range"] {
  width: 100%;
}
input[type="range"] {
  width: 100%;
}

/* El label ahora es el elemento clicable principal */
.radio-group label,
.checkbox-container label {
  position: relative;
  padding-left: 30px; /* Espacio para el nuevo checkbox/radio */
  cursor: pointer;
  user-select: none;
  font-size: 1em;
}

/* Creamos la caja/círculo base usando ::before */
.radio-group label::before,
.checkbox-container label::before {
  content: "";
  position: absolute;
  left: 0;
  top: 50%;
  transform: translateY(-50%);
  width: 20px;
  height: 20px;
  background-color: var(--input-bg);
  border: 2px solid var(--input-border);
  box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.5);
  transition: all 0.2s ease;
}

/* Forma de círculo para los radio buttons */
.radio-group label::before {
  border-radius: 50%;
}

/* Forma de cuadrado para los checkboxes */
.checkbox-container label::before {
  border-radius: 3px;
}

/* Cuando el input (que ahora es hermano) está seleccionado, cambiamos el borde del label adyacente */
input[type="checkbox"]:checked + label::before,
input[type="radio"]:checked + label::before {
  border-color: var(--text-gold);
  background-color: #4a3f3c;
}

/* Creamos la marca interior usando ::after */
.radio-group label::after,
.checkbox-container label::after {
  content: "";
  position: absolute;
  left: 0;
  top: 50%;
  transform: translateY(-50%) scale(0); /* Empieza invisible */
  opacity: 0;
  transition: all 0.2s ease-in-out;
}

/* Estilo para la marca del radio button (círculo dorado) */
input[type="radio"] + label::after {
  left: 5px; /* Centrado en la caja de 20px */
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background-color: var(--text-gold);
}

/* Estilo para la marca del checkbox (checkmark) */
input[type="checkbox"] + label::after {
  left: 7px;
  top: 40%; /* Ajuste para centrar visualmente el checkmark */
  width: 6px;
  height: 12px;
  border: solid var(--text-gold);
  border-width: 0 3px 3px 0;
  transform: translateY(-50%) rotate(45deg) scale(0);
}

/* Cuando el input está seleccionado, hacemos visible la marca interior */
input[type="checkbox"]:checked + label::after,
input[type="radio"]:checked + label::after {
  opacity: 1;
  transform: translateY(-50%) scale(1); /* La escala se anima desde 0 a 1 */
}

/* Regla específica para el checkmark para mantener la rotación */
input[type="checkbox"]:checked + label::after {
  transform: translateY(-50%) rotate(45deg) scale(1);
}

/* Efecto de foco para accesibilidad */
input[type="checkbox"]:focus-visible + label::before,
input[type="radio"]:focus-visible + label::before {
  outline: 2px solid var(--text-gold);
  outline-offset: 2px;
}
/* width */
::-webkit-scrollbar {
  width: 10px;
}

/* Track */
::-webkit-scrollbar-track {
  background: #3a2e2a;
}

/* Handle */
::-webkit-scrollbar-thumb {
  background: #966331;
}

/* Handle on hover */
::-webkit-scrollbar-thumb:hover {
  background: #555;
}
/* --- ESTILOS PARA EL MODO DE DIBUJO DE MUROS --- */
body.wall-drawing-mode .map-area {
  cursor: crosshair; /* Cambia el cursor cuando el modo está activo */
}

#toggleWallModeBtn.active {
  background: var(--button-vision-bg);
  border-color: #5dc66f;
  color: #fff;
  box-shadow: 0 0 10px #5dc66f;
}

/* --- ESTILOS PARA EL MODO DE ALINEACIÓN DE REJILLA --- */
#alignGridModeBtn.active {
  background: var(--button-vision-bg);
  border-color: #5dc66f;
  color: #fff;
  box-shadow: 0 0 10px #5dc66f;
}

body.grid-align-mode #mapContainer {
  cursor: crosshair;
}

input[type="range"] {
  /* removing default appearance */
  -webkit-appearance: none;
  appearance: none;
  /* creating a custom design */
  width: 100%;
  cursor: pointer;
  outline: none;
  /*  slider progress trick  */
  overflow: hidden;
  border-radius: 16px;
}

/* Track: webkit browsers */
input[type="range"]::-webkit-slider-runnable-track {
  height: 15px;
  background: var(--panel-bg);
  border-radius: 16px;
  /*border: solid 1px var(--panel-border);*/
}

/* Track: Mozilla Firefox */
input[type="range"]::-moz-range-track {
  height: 15px;
  background: #ccc;
  border-radius: 16px;
}

/* Thumb: webkit */
input[type="range"]::-webkit-slider-thumb {
  /* removing default appearance */
  -webkit-appearance: none;
  appearance: none;
  /* creating a custom design */
  height: 15px;
  width: 15px;
  background-color: var(--bg-dark);
  border-radius: 50%;
  border: 2px solid var(--text-gold);
  /*  slider progress trick  */
  box-shadow: -407px 0 0 400px var(--text-gold);
}

/* Thumb: Firefox */
input[type="range"]::-moz-range-thumb {
  height: 15px;
  width: 15px;
  background-color: #fff;
  border-radius: 50%;
  border: 1px solid var(--text-gold);
  /*  slider progress trick  */
  box-shadow: -407px 0 0 400px var(--text-gold) 0;
}

#cellSizeSlider {
  margin-bottom: 15px;
}
#mapContainer.no-map {
  display: flex;
  align-items: center;
  justify-content: center;
}

/* El mensaje de bienvenida */
.loading-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  color: #a0a0a0;
  text-align: center;
  font-family: "Cinzel", serif;
}

.loading-state p {
  font-size: 1.2em;
}
.loading-state img {
  width: 75%;
}

/* --- NUEVO: ESTILOS PARA EL ICONO GRANDE EN LOADING STATE --- */
.loading-state .icon {
  width: 80px; /* Tamaño del contenedor del icono */
  height: 80px; /* Tamaño del contenedor del icono */
  margin-bottom: 16px;
  opacity: 0.7; /* Ajusta opacidad si es necesario */
  animation: bounce 2s infinite ease-in-out; /* Mantén la animación */
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
}

/* --- NUEVO: CLASE ESPECÍFICA PARA EL ICONO DE LOADING STATE --- */
/* REEMPLAZA LA RUTA */
.icon-dice-large {
  background-image: url("https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/465e4532-5430-4be7-b49c-acf81087d8bd/dk284pr-9dfc6256-e224-42ee-8ed1-3919850a1ecd.png/v1/fill/w_894,h_894/carganoruna_icon_by_rafaelalvarez29_dk284pr-pre.png?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7ImhlaWdodCI6Ijw9MTAyNCIsInBhdGgiOiJcL2ZcLzQ2NWU0NTMyLTU0MzAtNGJlNy1iNDljLWFjZjgxMDg3ZDhiZFwvZGsyODRwci05ZGZjNjI1Ni1lMjI0LTQyZWUtOGVkMS0zOTE5ODUwYTFlY2QucG5nIiwid2lkdGgiOiI8PTEwMjQifV1dLCJhdWQiOlsidXJuOnNlcnZpY2U6aW1hZ2Uub3BlcmF0aW9ucyJdfQ.uOKJoXBapkzwmJG35gjiwFkz1UgiuTiphqmSdMVOfmE");
}

.icon-brush {
  background-image: url("https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/465e4532-5430-4be7-b49c-acf81087d8bd/dk282gr-f1662dbf-3e31-4a2d-8551-27b0f154b2a2.png/v1/fit/w_655,h_856/pincel_icon_by_rafaelalvarez29_dk282gr-375w-2x.png?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7ImhlaWdodCI6Ijw9ODU2IiwicGF0aCI6IlwvZlwvNDY1ZTQ1MzItNTQzMC00YmU3LWI0OWMtYWNmODEwODdkOGJkXC9kazI4MmdyLWYxNjYyZGJmLTNlMzEtNGEyZC04NTUxLTI3YjBmMTU0YjJhMi5wbmciLCJ3aWR0aCI6Ijw9NjU1In1dXSwiYXVkIjpbInVybjpzZXJ2aWNlOmltYWdlLm9wZXJhdGlvbnMiXX0.FFnNcEtf7gnPRLYhEZpmus8jAuMT6PO-uvi-solkONc");
}
.icon-grid {
  background-image: url("https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/465e4532-5430-4be7-b49c-acf81087d8bd/dk2bxyl-b1b71100-45cc-4aa2-b7e2-850eae7a4108.png/v1/fit/w_546,h_586/editarrejilla_icon2__by_rafaelalvarez29_dk2bxyl-375w-2x.png?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7ImhlaWdodCI6Ijw9NTg2IiwicGF0aCI6IlwvZlwvNDY1ZTQ1MzItNTQzMC00YmU3LWI0OWMtYWNmODEwODdkOGJkXC9kazJieHlsLWIxYjcxMTAwLTQ1Y2MtNGFhMi1iN2UyLTg1MGVhZTdhNDEwOC5wbmciLCJ3aWR0aCI6Ijw9NTQ2In1dXSwiYXVkIjpbInVybjpzZXJ2aWNlOmltYWdlLm9wZXJhdGlvbnMiXX0.PzvDY41ptuym_x4NnxOABsIsy_TqVX4l_sD5Cp7EsyQ");
}
.icon-align-grid {
  background-image: url("https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/465e4532-5430-4be7-b49c-acf81087d8bd/dk2bxyl-b1b71100-45cc-4aa2-b7e2-850eae7a4108.png/v1/fit/w_546,h_586/editarrejilla_icon2__by_rafaelalvarez29_dk2bxyl-375w-2x.png?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7ImhlaWdodCI6Ijw9NTg2IiwicGF0aCI6IlwvZlwvNDY1ZTQ1MzItNTQzMC00YmU3LWI0OWMtYWNmODEwODdkOGJkXC9kazJieHlsLWIxYjcxMTAwLTQ1Y2MtNGFhMi1iN2UyLTg1MGVhZTdhNDEwOC5wbmciLCJ3aWR0aCI6Ijw9NTQ2In1dXSwiYXVkIjpbInVybjpzZXJ2aWNlOmltYWdlLm9wZXJhdGlvbnMiXX0.PzvDY41ptuym_x4NnxOABsIsy_TqVX4l_sD5Cp7EsyQ");
}
/* Una pequeña animación para el icono */
@keyframes bounce {
  0%,
  20%,
  50%,
  80%,
  100% {
    transform: translateY(0);
  }
  40% {
    transform: translateY(-20px);
  }
  60% {
    transform: translateY(-10px);
  }
}
/* Estilo para el título principal */
.loading-state h1 {
  font-family: "IM Fell English SC", serif;
  font-size: 2.5em; /* Un poco más grande para que destaque */
  color: var(--text-gold);
  margin: 0 0 10px 0;
  text-shadow: 1px 1px 3px #000;
}

/* Estilo para el subtítulo motivador */
.loading-state h2 {
  font-family: "Cinzel", serif;
  font-size: 1.2em;
  font-weight: normal; /* Para no competir con el h1 */
  color: #c0c0c0; /* Un gris claro */
  margin: 0 0 20px 0;
  padding: 0;
  border: none; /* Aseguramos que no tenga bordes */
  text-shadow: none; /* Quitamos cualquier sombra de texto */
}

/* Ajustamos el párrafo para que no sea tan grande */
.loading-state p {
  max-width: 400px; /* Evita que el texto se haga demasiado ancho en pantallas grandes */
  font-size: 1em; /* Un tamaño de fuente más estándar */
  line-height: 1.5; /* Mejora la legibilidad */
}
body.wall-drawing-mode #mapContainer {
  cursor: crosshair;
}

/* 2. Estilos para la nueva lista de puertas en el panel */
#doorList {
  list-style: none;
  padding: 0;
  margin: 0;
}

#doorList li {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px;
  border-bottom: 1px solid var(--input-border);
  background-color: rgba(0, 0, 0, 0.1);
  transition: background-color 0.2s;
}

#doorList li:hover {
  background-color: rgba(255, 255, 255, 0.05);
}

.door-name {
  font-family: "Cinzel", serif;
  font-size: 1.1em;
}

.door-actions {
  display: flex;
  gap: 8px;
}

/* Botón de Abrir/Cerrar */
.toggle-door-btn {
  padding: 5px 10px;
  font-size: 0.9em;
  font-family: "Cinzel", serif;
  min-width: 80px; /* Ancho fijo para que no salte al cambiar el texto */
  margin: 0;
  border-radius: 3px;
  background: var(--header-hover);
  border: 1px solid var(--input-border);
  color: var(--text-light);
}
.toggle-door-btn:hover {
  background: var(--header-bg);
  color: white;
}
.toggle-door-btn.open {
  border-color: #5dc66f;
  color: #5dc66f;
}

/* Botón de eliminar puerta */
.delete-door-btn {
  background: none;
  border: 1px solid #c65d5d;
  color: #c65d5d;
  width: 28px;
  height: 28px;
  padding: 0;
  margin: 0;
  font-size: 1.2em;
  line-height: 26px;
  border-radius: 3px;
}
.delete-door-btn:hover {
  background: #a13535;
  color: white;
}

#noDoorsMessage {
  text-align: center;
  padding: 15px;
}

/* --- AÑADE ESTA REGLA A TU STYLE.CSS --- */

/* Estilo para el input de edición del nombre de la puerta */
.door-name-edit {
  background-color: var(--input-bg);
  border: 1px solid var(--text-gold);
  color: var(--text-light);
  font-family: "Cinzel", serif;
  font-size: 1.1em;
  padding: 4px 6px;
  border-radius: 3px;
  width: 50%; /* Ocupa un espacio razonable */
}
/* --- ESTILOS PARA IMÁGENES DE FICHAS --- */

/* 1. Botón de carga de imagen más pequeño */
.custom-file-upload-btn.small-btn {
  padding: 8px 12px;
  font-size: 0.9em;
  margin-bottom: 5px;
  border-style: solid; /* Cambiamos a sólido para que se vea más como un botón normal */
}
#tokenImageName {
  margin-bottom: 10px;
}

/* 2. Estilos para la ficha en el mapa cuando tiene imagen */
.token.has-image {
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  font-size: 0; /* Oculta el texto de la letra si hay imagen */
}

/* 3. Estilos para la vista previa de imagen en el editor */
#editTokenImagePreviewContainer {
  position: relative;
  width: 100px;
  height: 100px;
  margin: 0 auto 15px; /* Centra el contenedor */
}

#editTokenImagePreview {
  width: 100%;
  height: 100%;
  border-radius: 50%;
  border: 3px solid var(--text-gold);
  object-fit: cover; /* Asegura que la imagen llene el círculo sin deformarse */
}

/* El círculo para la letra/color */
.token-preview-letter {
  width: 100%;
  height: 100%;
  border-radius: 50%;
  border: 3px solid var(--text-gold);
  display: flex;
  align-items: center;
  justify-content: center;
  font-family: "IM Fell English SC", serif;
  font-size: 3.5em; /* Tamaño grande para la letra */
  color: white;
  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
  box-sizing: border-box; /* Incluye el borde en el tamaño total */
}

/* Aseguramos que la imagen y el preview de letra ocupen el mismo espacio */
#editTokenImagePreview,
.token-preview-letter {
  position: absolute;
  top: 0;
  left: 0;
}

/* Botón para cambiar la imagen */
.change-image-btn {
  position: absolute;
  bottom: 0;
  right: 0;
  width: 30px;
  height: 30px;
  background: var(--header-bg);
  color: var(--text-gold);
  border-radius: 50%;
  border: 1px solid var(--panel-border);
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  font-size: 1.2em;
  transition: background-color 0.2s;
}
.change-image-btn:hover {
  background: var(--header-hover);
}

/* Botón para quitar la imagen */
.remove-image-btn {
  position: absolute;
  top: 0;
  right: 0;
  width: 24px;
  height: 24px;
  background: #8c2d2d;
  color: white;
  border: 1px solid #c65d5d;
  border-radius: 50%;
  padding: 0;
  margin: 0;
  font-size: 1.1em;
  line-height: 22px;
  cursor: pointer;
}
.remove-image-btn:hover {
  background: #a13535;
}
/* --- ESTILOS PARA MODALES (ACTUALIZADO CON TU DISEÑO) --- */
.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.7);
  backdrop-filter: blur(5px);
  display: none; /* Oculto por defecto */
  align-items: center;
  justify-content: center;
  z-index: 1000;
  opacity: 0;
  transition: opacity 0.3s ease-out;
  animation: modal-fade-in 0.3s ease-out;
}

.modal-overlay.open {
  display: flex;
  opacity: 1;
}

/* Modal PEQUEÑO (Para guardar nombre) */
.modal-content {
  background: var(--panel-bg);
  padding: 25px;
  border-radius: 8px;
  border: 1px solid var(--panel-border);
  box-shadow: 0 5px 25px rgba(0, 0, 0, 0.5);
  width: 90%;
  max-width: 500px;
  position: relative;
  transform: scale(0.95);
  transition: transform 0.3s ease;
}

.modal-overlay.open .modal-content {
  transform: scale(1);
}

.modal-content h3 {
  font-family: "IM Fell English SC", serif;
  font-size: 1.8em;
  text-align: center;
  color: var(--text-gold);
  margin-top: 0;
  margin-bottom: 20px;
}

/* Modal GRANDE (Para ver escenas) */
.saved-scenes-modal {
  background: var(--panel-bg);
  border: 3px solid var(--panel-border);
  border-radius: 12px;
  width: 90%;
  max-width: 1100px;
  max-height: 90vh;
  display: flex;
  flex-direction: column;
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.8);
  animation: modal-slide-in 0.4s cubic-bezier(0.25, 1, 0.5, 1);
}

.modal-header {
  padding: 20px 25px;
  border-bottom: 2px solid var(--panel-border);
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: linear-gradient(135deg, var(--header-bg), var(--panel-bg));
  flex-shrink: 0;
}

.modal-title {
  font-family: "IM Fell English SC", serif;
  font-size: 2.2em;
  color: var(--text-gold);
  margin: 0;
  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
}

.modal-close-btn {
  background: #8c2d2d;
  color: white;
  border: 2px solid #c65d5d;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  font-size: 1.8em;
  font-weight: bold;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0;
  margin: 0;
  flex-shrink: 0;
}
.modal-close-btn:hover {
  background: #a13535;
  transform: scale(1.1);
}

/* --- ESTILOS PARA LISTA DE ESCENAS GUARDADAS (NUEVO DISEÑO) --- */
.modal-content-body {
  padding: 25px;
  overflow-y: auto;
  flex-grow: 1;
}

.saved-scenes-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 25px;
}

.scene-card {
  background: var(--content-bg);
  border: 2px solid var(--input-border);
  border-radius: 10px;
  overflow: hidden;
  transition: all 0.3s ease;
  cursor: pointer;
  position: relative;
  display: flex;
  flex-direction: column;
}
.scene-card:hover {
  border-color: var(--text-gold);
  transform: translateY(-5px);
  box-shadow: 0 8px 25px rgba(230, 194, 83, 0.2);
}

.scene-card-image-container {
  position: relative;
  width: 100%;
  height: 180px;
  overflow: hidden;
  background: #000;
}
.scene-card-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform 0.3s ease;
}
.scene-card:hover .scene-card-image {
  transform: scale(1.05);
}

.scene-card-info-overlay {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  background: linear-gradient(transparent, rgba(0, 0, 0, 0.9));
  padding: 40px 15px 15px 15px;
  color: white;
  text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.8);
}
.scene-card-name {
  font-family: "IM Fell English SC", serif;
  font-size: 1.4em;
  color: var(--text-gold);
  margin: 0 0 5px 0;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.scene-card-date {
  font-family: "Cinzel", serif;
  font-size: 0.8em;
  color: #c0c0c0;
  margin: 0;
}

.scene-card-body {
  padding: 15px;
  border-top: 1px solid var(--input-border);
}
.scene-card-stats {
  display: flex;
  justify-content: space-around;
  font-size: 0.9em;
  color: #a0a0a0;
}

/* --- NUEVO: ESTILOS PARA LOS ICONOS DE ESTADÍSTICAS DE ESCENA --- */
.scene-card-stat-item {
  display: flex;
  align-items: center;
  gap: 8px;
}
.scene-card-stat-icon {
  font-size: 1.2em; /* Mantenemos el tamaño del contenedor */
  display: inline-block; /* Asegura que el span se comporte como un bloque en línea */
  width: 1em; /* Ajusta el tamaño del icono */
  height: 1em; /* Ajusta el tamaño del icono */
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
}

/* --- NUEVO: CLASES ESPECÍFICAS PARA LOS ICONOS DE ESTADÍSTICAS --- */
/* REEMPLAZA LAS RUTAS */
.icon-stat-token {
  background-image: url("https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/465e4532-5430-4be7-b49c-acf81087d8bd/dk2826w-6b17b7c5-0f58-4c59-9457-29763234d533.png/v1/fit/w_574,h_759/ficha_icon_by_rafaelalvarez29_dk2826w-375w-2x.png?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7ImhlaWdodCI6Ijw9NzU5IiwicGF0aCI6IlwvZlwvNDY1ZTQ1MzItNTQzMC00YmU3LWI0OWMtYWNmODEwODdkOGJkXC9kazI4MjZ3LTZiMTdiN2M1LTBmNTgtNGM1OS05NDU3LTI5NzYzMjM0ZDUzMy5wbmciLCJ3aWR0aCI6Ijw9NTc0In1dXSwiYXVkIjpbInVybjpzZXJ2aWNlOmltYWdlLm9wZXJhdGlvbnMiXX0.ecJ1Y7MbiTskxHcKPmmKWW4a8O6YA67wjxwMoIPZIjU");
}
.icon-stat-wall {
  background-image: url("https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/465e4532-5430-4be7-b49c-acf81087d8bd/dk27xrv-d8c11b91-d059-42e1-922c-39233f7d587f.png/v1/fill/w_884,h_837/muro_icon_by_rafaelalvarez29_dk27xrv-fullview.png?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7ImhlaWdodCI6Ijw9ODM3IiwicGF0aCI6IlwvZlwvNDY1ZTQ1MzItNTQzMC00YmU3LWI0OWMtYWNmODEwODdkOGJkXC9kazI3eHJ2LWQ4YzExYjkxLWQwNTktNDJlMS05MjJjLTM5MjMzZjdkNTg3Zi5wbmciLCJ3aWR0aCI6Ijw9ODg0In1dXSwiYXVkIjpbInVybjpzZXJ2aWNlOmltYWdlLm9wZXJhdGlvbnMiXX0.Gsorh3ss3jCQIFRYym-JjKfx7KIgnU6l3DuI3KM02bw");
}
.icon-stat-door {
  background-image: url("https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/465e4532-5430-4be7-b49c-acf81087d8bd/dk27xzc-36669da6-1875-409f-83e5-61a04b750924.png/v1/fit/w_602,h_848/puerta_icon_by_rafaelalvarez29_dk27xzc-375w-2x.png?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7ImhlaWdodCI6Ijw9ODQ4IiwicGF0aCI6IlwvZlwvNDY1ZTQ1MzItNTQzMC00YmU3LWI0OWMtYWNmODEwODdkOGJkXC9kazI3eHpjLTM2NjY5ZGE2LTE4NzUtNDA5Zi04M2U1LTYxYTA0Yjc1MDkyNC5wbmciLCJ3aWR0aCI6Ijw9NjAyIn1dXSwiYXVkIjpbInVybjpzZXJ2aWNlOmltYWdlLm9wZXJhdGlvbnMiXX0.Y989bL2cMG4fX4jmwQvfM2hTQZmPqv1oTh9DEXIIp44");
}

.delete-scene-btn {
  position: absolute;
  top: 10px;
  right: 10px;
  background: rgba(140, 45, 45, 0.85);
  color: white;
  border: 1px solid #c65d5d;
  width: 32px;
  height: 32px;
  border-radius: 50%;
  font-size: 1.3em;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  transform: scale(0.8);
  transition: all 0.2s ease-out;
  backdrop-filter: blur(3px);
  z-index: 5;
}
.scene-card:hover .delete-scene-btn {
  opacity: 1;
  transform: scale(1);
}
.delete-scene-btn:hover {
  background: rgba(161, 53, 53, 1);
  transform: scale(1.1) !important;
}

/* Mensaje cuando no hay mapas guardados */
#no-scenes-message {
  grid-column: 1 / -1;
  text-align: center;
  padding: 60px 20px;
  color: #888;
}
/* .icon ya tiene estilos base, añadimos la imagen específica */
.icon-map-large {
  background-image: url("https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/465e4532-5430-4be7-b49c-acf81087d8bd/dk2807e-bf125877-efc8-4136-97d7-e6b8bd53da39.png/v1/fit/w_674,h_707/mapa_icon_by_rafaelalvarez29_dk2807e-375w-2x.png?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7ImhlaWdodCI6Ijw9NzA3IiwicGF0aCI6IlwvZlwvNDY1ZTQ1MzItNTQzMC00YmU3LWI0OWMtYWNmODEwODdkOGJkXC9kazI4MDdlLWJmMTI1ODc3LWVmYzgtNDEzNi05N2Q3LWU2YjhiZDUzZGEzOS5wbmciLCJ3aWR0aCI6Ijw9Njc0In1dXSwiYXVkIjpbInVybjpzZXJ2aWNlOmltYWdlLm9wZXJhdGlvbnMiXX0.KFdtHEY3m67t_O4ES74Pr_pH9yK6Oa3n0Yc6MJR3tAA");
} /* REEMPLAZA LA RUTA */

#no-scenes-message .icon {
  font-size: 4em; /* Este tamaño ahora define el tamaño del contenedor del icono */
  color: #666; /* Este color ya no afecta la imagen, puedes quitarlo si quieres */
  margin-bottom: 20px;
  opacity: 0.5;
  /* Añadido del CSS de .loading-state .icon */
  display: inline-block; /* Necesario para width/height */
  width: 1em;
  height: 1em; /* Usa font-size para definir el tamaño */
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
}

#no-scenes-message h3 {
  font-family: "IM Fell English SC", serif;
  font-size: 1.8em;
  color: #999;
  margin: 0 0 15px 0;
}
#no-scenes-message p {
  font-family: "Cinzel", serif;
  font-size: 1.1em;
  line-height: 1.5;
  max-width: 400px;
  margin: 0 auto;
}

/* Ajusta los márgenes del radio group cuando está dentro de un form-group */
.form-group .radio-group {
  margin-top: 5px;
  margin-bottom: 0;
}

/* Wrapper para alinear el botón de carga de archivo y el nombre */
.file-upload-wrapper {
  display: flex;
  align-items: center;
  gap: 10px;
}

/* Quita márgenes automáticos de los elementos dentro del wrapper para que flex los controle */
.file-upload-wrapper .custom-file-upload-btn,
.file-upload-wrapper .file-name-display {
  margin: 0;
}

/* El botón no se encoge */
.file-upload-wrapper .custom-file-upload-btn {
  flex-shrink: 0;
}

/* El nombre del archivo ocupa el espacio restante */
.file-upload-wrapper .file-name-display {
  flex-grow: 1;
}

/* Ajuste menor para la textarea sin label explícito */
.token-editor-form h4 + .form-group textarea {
  width: calc(100% - 20px); /* Ajuste por el padding del form-group */
}

/* --- ESTILO PARA MENSAJE DE LISTA DE FICHAS VACÍA (NUEVO) --- */
.no-tokens-message {
  text-align: center;
  padding: 20px 15px;
  font-size: 0.9em;
  color: #888;
  font-style: italic;
  background-color: rgba(0, 0, 0, 0.1);
  border-radius: 3px;
}

/* --- ESTILOS PARA TRACKER DE TURNOS DE JUGADOR (NUEVO) --- */
#playerTurnTracker {
  position: fixed;
  top: 20px;
  right: 20px;
  width: 300px;
  max-height: calc(100vh - 40px);

  z-index: 10;
  overflow-y: auto;
  overflow-x: hidden;
  color: var(--text-light);
  /* box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5);
  background-color: #1f1614d9;
  backdrop-filter: blur(8px);
  border: 2px none var(--panel-border);
  border-radius: 10px;*/
}

.player-token-card {
  position: relative; /* Necesario para que la capa ::before se posicione correctamente */
  display: flex;
  align-items: center;
  padding: 12px;
  border-bottom: 1px solid var(--input-border);
  gap: 12px;
  box-shadow: 0 5px 20px rgba(0, 0, 0, 0.5);
  background-color: #1f1614d9;
  /*backdrop-filter: blur(8px);*/
  border: 2px none var(--panel-border);
  background: linear-gradient(
    to right,
    rgba(0, 0, 0, 0.4),
    rgba(0, 0, 0, 0.2),
    rgba(0, 0, 0, 0.1),
    rgba(0, 0, 0, 0)
  );
  clip-path: polygon(5% 0%, 100% 0%, 100% 100%, 0% 100%);
  margin: 10px;
}

.player-token-card:last-child {
  border-bottom: none;
}

.player-token-preview {
  width: 50px;
  height: 50px;
  border-radius: 50%;
  flex-shrink: 0;
  background-size: cover;
  background-position: center;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  font-size: 1.5em;
  color: white;
  text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
  border: 2px solid #555;
}

.player-token-info {
  flex-grow: 1;
  min-width: 0; /* Permite que los elementos flex se encojan correctamente */
}

.player-token-name {
  font-family: "IM Fell English SC", serif;
  font-size: 1.2em;
  font-weight: bold;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.player-token-initiative {
  font-size: 0.8em;
  color: #b0b0b0;
  margin-bottom: 8px;
}

.health-bar-container {
  width: 100%;
  height: 12px;
  background-color: #1a1a1a;
  border-radius: 6px;
  overflow: hidden;
  border: 1px solid #4a3f3c;
}

.health-bar-fill {
  height: 100%;
  border-radius: 6px;
  transition: width 0.3s ease, background-color 0.3s ease;
}

/* Reutilizamos las clases de color para la barra de vida */
.health-bar-fill.health-high {
  background-color: #5dff8b;
}
.health-bar-fill.health-mid {
  background-color: #ffee5d;
}
.health-bar-fill.health-low {
  background-color: #ff5d5d;
}
.health-bar-fill.health-critical {
  background-color: #a93232;
}

.player-token-states {
  display: flex;
  gap: 5px;
  margin-top: 8px;
  font-size: 1.2em;
}

.player-token-states span {
  cursor: help; /* Indica que se puede obtener info al pasar el ratón */
}

/* --- ESTILOS PARA EDITOR DE ESTADOS (NUEVO) --- */
#tokenStatesEditor {
  margin-top: 20px;
}

button.small-btn {
  width: auto;
  padding: 8px 15px;
  font-size: 0.9em;
  margin-top: 10px;
}

#editTokenStatesList {
  list-style: none;
  padding: 0;
  margin-top: 15px;
}

#editTokenStatesList li {
  display: flex;
  align-items: center;
  gap: 10px;
  background-color: rgba(0, 0, 0, 0.2);
  padding: 8px 12px;
  border-radius: 3px;
  margin-bottom: 5px;
}

#editTokenStatesList .state-emoji {
  font-size: 1.3em;
}
#editTokenStatesList .state-desc {
  flex-grow: 1;
  font-size: 0.9em;
}
#editTokenStatesList .delete-state-btn {
  background: none;
  border: 1px solid #c65d5d;
  color: #c65d5d;
  width: 24px;
  height: 24px;
  padding: 0;
  margin: 0;
  font-size: 1em;
  line-height: 22px;
  border-radius: 50%;
}
#editTokenStatesList .delete-state-btn:hover {
  background: #a13535;
  color: white;
}
/* --- AÑADE ESTO AL FINAL DE style.css --- */

/* Animaciones para las tarjetas de jugador en el tracker (VERSIÓN CON CAMBIO DE FONDO) */
.player-token-card {
  position: relative; /* Necesario para que la capa ::before se posicione correctamente */
  /* NOTA: Asegúrate de que esta línea esté presente en tu regla .player-token-card */
}

/* 2. Definimos la capa de color invisible que usaremos para el flash */
.player-token-card::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;

  /* Hacemos que la capa tenga la misma forma que la tarjeta */
  border-radius: inherit;
  clip-path: inherit;

  /* Por defecto, la capa es invisible y no se puede hacer clic en ella */
  opacity: 0;
  pointer-events: none;

  /* El color se lo daremos después */
  background-color: transparent;

  /* Una transición suave por si acaso */
  transition: background-color 0.2s;
}

/* 3. APLICAMOS LAS ANIMACIONES CUANDO LA CLASE SE AÑADE */

/* DAÑO: */
/* La tarjeta principal se encarga de la SACUDIDA */
.player-token-card.card-damaged {
  animation: token-shake 0.4s ease-out;
}
/* La capa invisible se encarga del FLASH DE COLOR */
.player-token-card.card-damaged::before {
  background-color: rgba(180, 50, 50, 0.7); /* Color del flash de daño */
  animation: flash-overlay 0.4s ease-out;
}

/* CURACIÓN: */
/* La tarjeta principal se encarga del PULSO/TAMBALEO */
.player-token-card.card-healed {
  animation: card-pulse-scale 0.5s ease-out;
}
/* La capa invisible se encarga del FLASH DE COLOR */
.player-token-card.card-healed::before {
  background-color: rgba(50, 180, 80, 0.6); /* Color del flash de curación */
  animation: flash-overlay 0.5s ease-out;
}

/* 4. DEFINICIÓN DE LOS KEYFRAMES */

/* Se mantiene la animación de sacudida original de la ficha */
@keyframes token-shake {
  10%,
  90% {
    transform: translate3d(-1px, 0, 0);
  }
  20%,
  80% {
    transform: translate3d(2px, 0, 0);
  }
  30%,
  50%,
  70% {
    transform: translate3d(-4px, 0, 0);
  }
  40%,
  60% {
    transform: translate3d(4px, 0, 0);
  }
}

/* Una animación de pulso/escala más suave para la curación */
@keyframes card-pulse-scale {
  0%,
  100% {
    transform: scale(1);
  }
  50% {
    transform: scale(1.02);
  }
}

/* La animación clave para el flash de la capa (solo anima la opacidad) */
@keyframes flash-overlay {
  0%,
  100% {
    opacity: 0;
  }
  50% {
    opacity: 1;
  }
}

/* --- ESTILOS PARA RADIO BUTTONS TIPO TILE (NUEVO) --- */

.radio-tile-group {
  display: flex;
  justify-content: space-around; /* Distribuye el espacio entre los tiles */
  gap: 1rem;
  margin-top: 10px;
}

.radio-tile-group .input-container {
  position: relative;
  height: 90px;
  flex: 1; /* Hace que ambos tiles ocupen el espacio disponible */
  max-width: 180px; /* Un ancho máximo para que no se estiren demasiado */
}

/* El input de radio real, oculto pero funcional */
.radio-tile-group .input-container .radio-button {
  opacity: 0;
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  width: 100%;
  margin: 0;
  cursor: pointer;
}

/* El tile visible */
.radio-tile-group .input-container .radio-tile {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  width: 100%;
  height: 100%;
  border: 2px solid var(--input-border);
  border-radius: 8px;
  background: var(--content-bg);
  transition: all 0.2s ease-in-out;
  box-sizing: border-box;
}

/* El contenedor del icono dentro del tile (ahora será un span vacío con background-image) */
.radio-tile-group .input-container .radio-tile-icon {
  font-size: 2.5em; /* Este tamaño define el tamaño del contenedor del icono */
  line-height: 1;
  margin-bottom: 8px;
  /* NUEVO: Estilos para la imagen de fondo */
  display: inline-block; /* Necesario para width/height */
  width: 1em;
  height: 1em; /* Usa font-size para definir el tamaño */
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
}

/* --- NUEVO: CLASES ESPECÍFICAS PARA LOS ICONOS DE RADIO TILES --- */
/* REEMPLAZA LAS RUTAS */
.icon-wall-draw {
  background-image: url("https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/465e4532-5430-4be7-b49c-acf81087d8bd/dk27xrv-d8c11b91-d059-42e1-922c-39233f7d587f.png/v1/fill/w_884,h_837/muro_icon_by_rafaelalvarez29_dk27xrv-fullview.png?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7ImhlaWdodCI6Ijw9ODM3IiwicGF0aCI6IlwvZlwvNDY1ZTQ1MzItNTQzMC00YmU3LWI0OWMtYWNmODEwODdkOGJkXC9kazI3eHJ2LWQ4YzExYjkxLWQwNTktNDJlMS05MjJjLTM5MjMzZjdkNTg3Zi5wbmciLCJ3aWR0aCI6Ijw9ODg0In1dXSwiYXVkIjpbInVybjpzZXJ2aWNlOmltYWdlLm9wZXJhdGlvbnMiXX0.Gsorh3ss3jCQIFRYym-JjKfx7KIgnU6l3DuI3KM02bw");
}
.icon-door-draw {
  background-image: url("https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/465e4532-5430-4be7-b49c-acf81087d8bd/dk27xzc-36669da6-1875-409f-83e5-61a04b750924.png/v1/fit/w_602,h_848/puerta_icon_by_rafaelalvarez29_dk27xzc-375w-2x.png?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7ImhlaWdodCI6Ijw9ODQ4IiwicGF0aCI6IlwvZlwvNDY1ZTQ1MzItNTQzMC00YmU3LWI0OWMtYWNmODEwODdkOGJkXC9kazI3eHpjLTM2NjY5ZGE2LTE4NzUtNDA5Zi04M2U1LTYxYTA0Yjc1MDkyNC5wbmciLCJ3aWR0aCI6Ijw9NjAyIn1dXSwiYXVkIjpbInVybjpzZXJ2aWNlOmltYWdlLm9wZXJhdGlvbnMiXX0.Y989bL2cMG4fX4jmwQvfM2hTQZmPqv1oTh9DEXIIp44");
}
.icon-player-type {
  background-image: url("https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/465e4532-5430-4be7-b49c-acf81087d8bd/dk280pi-d5a22ac5-2d1e-49cf-8950-ea3da33ffb94.png/v1/fit/w_720,h_867/jugador_icon_by_rafaelalvarez29_dk280pi-375w-2x.png?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7ImhlaWdodCI6Ijw9ODY3IiwicGF0aCI6IlwvZlwvNDY1ZTQ1MzItNTQzMC00YmU3LWI0OWMtYWNmODEwODdkOGJkXC9kazI4MHBpLWQ1YTIyYWM1LTJkMWUtNDljZi04OTUwLWVhM2RhMzNmZmI5NC5wbmciLCJ3aWR0aCI6Ijw9NzIwIn1dXSwiYXVkIjpbInVybjpzZXJ2aWNlOmltYWdlLm9wZXJhdGlvbnMiXX0.xFjM5mMj-NGZYvdFJzsZItT4jz5ZCERid4abqKijNNk");
  filter: drop-shadow(0 0 5px #fffbc8)
    /* Un resplandor exterior, rojo y más difuso */
    drop-shadow(0 0 15px #ffd30e);
  pointer-events: none;
}
.icon-enemy-type {
  background-image: url("https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/465e4532-5430-4be7-b49c-acf81087d8bd/dk280si-23ebfeac-29eb-4e9a-9cf3-af3d666e6828.png/v1/fit/w_679,h_874/enemigo_icon_by_rafaelalvarez29_dk280si-375w-2x.png?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7ImhlaWdodCI6Ijw9ODc0IiwicGF0aCI6IlwvZlwvNDY1ZTQ1MzItNTQzMC00YmU3LWI0OWMtYWNmODEwODdkOGJkXC9kazI4MHNpLTIzZWJmZWFjLTI5ZWItNGU5YS05Y2YzLWFmM2Q2NjZlNjgyOC5wbmciLCJ3aWR0aCI6Ijw9Njc5In1dXSwiYXVkIjpbInVybjpzZXJ2aWNlOmltYWdlLm9wZXJhdGlvbnMiXX0.SEXeiU9RgxFAglrgdhWff-z-FCA_TyOJZ9SGd1CVsWU");
  filter: drop-shadow(0 0 12px rgb(255, 75, 255));
  pointer-events: none;
}

/* La etiqueta de texto dentro del tile */
.radio-tile-group .input-container .radio-tile-label {
  text-align: center;
  font-size: 0.9em;
  font-family: "IM Fell English SC", serif;
  font-weight: 600;
  color: var(--text-light);
  letter-spacing: 1px;
  pointer-events: none;
}

/* --- El estado cuando está SELECCIONADO --- */
.radio-tile-group .input-container .radio-button:checked + .radio-tile {
  background-color: var(--header-hover);
  border: 2px solid var(--text-gold);
  color: var(--text-gold); /* Esto cambia el color del texto */
  transform: scale(1.05);
  box-shadow: 0 0 10px rgba(230, 194, 83, 0.3);
}

/* Asegura que el icono también cambie de color si la imagen es un SVG o tiene colores que se pueden cambiar */
/* Si tus iconos son PNGs con colores fijos, esta regla podría no tener efecto visual en el icono en sí,
   pero sí en la etiqueta de texto. */
.radio-tile-group
  .input-container
  .radio-button:checked
  + .radio-tile
  .radio-tile-icon {
  /* Si usas SVGs y quieres cambiar su color con CSS, podrías añadir filtros */
  /* filter: invert(50%) sepia(200%) saturate(2000%) hue-rotate(20deg); */ /* Ejemplo de filtro */
}

.radio-tile-group
  .input-container
  .radio-button:checked
  + .radio-tile
  .radio-tile-label {
  color: var(--text-gold);
}

/* Icono para la nueva sección de Ambientación */
.icon-ambiance {
  background-image: url("https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/465e4532-5430-4be7-b49c-acf81087d8bd/dk2d8n7-f3c81512-6d0b-4c8f-857e-98f18fde5d9a.png/v1/fit/w_706,h_708/ambiente_icon_by_rafaelalvarez29_dk2d8n7-375w-2x.png?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7ImhlaWdodCI6Ijw9NzA4IiwicGF0aCI6IlwvZlwvNDY1ZTQ1MzItNTQzMC00YmU3LWI0OWMtYWNmODEwODdkOGJkXC9kazJkOG43LWYzYzgxNTEyLTZkMGItNGM4Zi04NTdlLTk4ZjE4ZmRlNWQ5YS5wbmciLCJ3aWR0aCI6Ijw9NzA2In1dXSwiYXVkIjpbInVybjpzZXJ2aWNlOmltYWdlLm9wZXJhdGlvbnMiXX0.3Hgg4rklFWP1EGV9orJeuE6bH_3hXTRASghJxBdLRFE");
}

/* Rejilla para la botonera de sonidos */
.sound-board-grid {
  display: grid;
  /* Crea 4 columnas de igual tamaño que ocupan el espacio disponible */
  grid-template-columns: repeat(4, 1fr);
  gap: 10px; /* Espacio entre los botones */
}

/* Estilo para los botones de sonido individuales */
.sound-btn {
  margin-top: 0; /* Anula el margen por defecto de los botones */
  padding: 10px 5px; /* Padding más pequeño para que no sean tan altos */
  font-size: 0.9em; /* Fuente ligeramente más pequeña */
  background: var(--header-bg); /* Un color base más sutil */
  border-color: var(--input-border);
  transition: all 0.2s ease;
}

.sound-btn:hover {
  background: var(--header-hover);
  border-color: var(--text-gold);
}

/* Estilo para el botón que está activo (reproduciendo un loop) */
.sound-btn.active {
  background: var(
    --button-vision-bg
  ); /* Un color verde para indicar que está activo */
  border-color: #5dc66f;
  color: #fff;
  box-shadow: 0 0 8px #5dc66f;
}
#aoeCanvas {
  position: absolute;
  top: 0;
  left: 0;
  pointer-events: none; /* ¡Muy importante! Permite que los clics atraviesen el canvas */
  z-index: 5; /* Por encima de la niebla, pero por debajo de las fichas seleccionadas */
  opacity: 0.6; /* Hacemos el área semi-transparente */
}

/* Ajustes para el grupo de botones de selección de forma */
#aoeShapeSelector {
  grid-template-columns: repeat(5, 1fr); /* 5 botones en la misma fila */
  gap: 5px;
}

#aoeShapeSelector button {
  padding: 8px 5px; /* Padding más ajustado */
  font-size: 0.9em;
  margin-top: 0;
}

/* Estilo para el botón de forma que está activo */
#aoeShapeSelector button.active {
  background: var(--button-vision-bg);
  border-color: #5dc66f;
  color: #fff;
  box-shadow: 0 0 10px #5dc66f;
}

/* El contenedor de los parámetros de cada forma */
#aoeParamsContainer .form-group {
    margin-bottom: 0;
}